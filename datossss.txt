SERVCODI|COPSPLSU|SERVDESC|CONCCODI|CONCDESC|REGLA|REGLA_UNICA
701|462|ENERG페 MDO REGULADO|90|CONSUMO ACTIVA|if(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,inuTipoComp=49;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(Peri_liqu);idtFinalDate=FDTGETFINALCONSUMDATE(Peri_liqu);inuClasServ=PE_GETCLASSSERVICE(inuTipoComp,idtFinalDate);if(inuClasServ=-1,IsbCriterioClaseGen=3112;IsbCriterioClase=UT_CONVERT.FSBNUMBERTOCHAR(IsbCriterioClaseGen);,IsbCriterioClase=UT_CONVERT.FSBNUMBERTOCHAR(inuClasServ););TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBTIPOCOMP(),inuTipoComp);TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBCLASESER(),IsbCriterioClase);TipoConsumo=3;TipoConsumo2=13;unidades_aforadas=GETCONSUNITPERTYPE(TipoConsumo2,Peri_liqu);InuFOT=1;IsbDirectrank="N";IsbPerstariff="N";PE_GETCONSUMDATESPERID(3,IdtFechaIni,IdtFechaFin);Consumo=LIQCHARGESCONSBYRANKS(TipoConsumo,InuFOT,IsbDirectrank,IsbPerstariff,IdtFechaIni,IdtFechaFin,unidades_aforadas);PKINSTANCEDATAMGR.GETCG_CONSECCACHE(nuconsecutivo);consecutivo1=UPDCONSLIQBYPERTYPE(TipoConsumo2,nuconsecutivo);,)|IF(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,INUTIPOCOMP=##;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(PERI_LIQU);IDTFINALDATE=FDTGETFINALCONSUMDATE(PERI_LIQU);INUCLASSERV=PE_GETCLASSSERVICE(INUTIPOCOMP,IDTFINALDATE);IF(INUCLASSERV=-#,ISBCRITERIOCLASEGEN=####;ISBCRITERIOCLASE=UT_CONVERT.FSBNUMBERTOCHAR(ISBCRITERIOCLASEGEN);,ISBCRITERIOCLASE=UT_CONVERT.FSBNUMBERTOCHAR(INUCLASSERV););TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBTIPOCOMP(),INUTIPOCOMP);TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBCLASESER(),ISBCRITERIOCLASE);TIPOCONSUMO=#;TIPOCONSUMO#=##;UNIDADES_AFORADAS=GETCONSUNITPERTYPE(TIPOCONSUMO#,PERI_LIQU);INUFOT=#;ISBDIRECTRANK="N";ISBPERSTARIFF="N";PE_GETCONSUMDATESPERID(#,IDTFECHAINI,IDTFECHAFIN);CONSUMO=LIQCHARGESCONSBYRANKS(TIPOCONSUMO,INUFOT,ISBDIRECTRANK,ISBPERSTARIFF,IDTFECHAINI,IDTFECHAFIN,UNIDADES_AFORADAS);PKINSTANCEDATAMGR.GETCG_CONSECCACHE(NUCONSECUTIVO);CONSECUTIVO#=UPDCONSLIQBYPERTYPE(TIPOCONSUMO#,NUCONSECUTIVO);,)
701|462|ENERG페 MDO REGULADO|530|IMPUESTO ALUMBRADO P２LICO|Dpto=STATE();Localidad=OBTLOCALIDADINSTPROD();Categoria=CATEGORY();inuCompType=-1;inuClassServ=-1;inuConcept=null;inuFOT=1;isbPersTariff="N";isbProportionality="S";InuConsumtype=3;Liquida=0;PE_GETCONSUMDATESPERID(InuConsumtype,IdtFechaini,IdtFechafin);if(Categoria=1,Liquida=1;,if(Categoria>=2&&Categoria<=14,if(Localidad=5001||Localidad=5079||Localidad=5212||Localidad=5686||Localidad=5360||Localidad=5308,PKINSTANCEDATAMGR.OBTCANTIDADCOMPONENTES(OnuCantComponentes);if(OnuCantComponentes=1,PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(nuPeriodo);nuPeriodoActual=OBTSIPERIODOACTUAL();sbAnoMes=OBTCADPEFAPECOLIQ(nuPeriodo);if(nuPeriodoActual=1,sbDocumentoSoporte=UT_STRING.FSBCONCAT("CM",sbAnoMes,"-");,sbDocumentoSoporte=UT_STRING.FSBCONCAT("CM-PR",sbAnoMes,"-"););PKINSTANCEDATAMGR.GETCG_COMPONENT(nuComponente);sbDocumentoSoporte=UT_STRING.FSBCONCAT(sbDocumentoSoporte,nuComponente,"-IC-");SETSUPPORTDOC(sbDocumentoSoporte);nuUnidades1=GETCONSUNITPERTYPE(1,nuPeriodo);nuUnidades2=GETCONSUNITPERTYPE(2,nuPeriodo);nuUnidades3=GETCONSUNITPERTYPE(3,nuPeriodo);nuUnidades4=GETCONSUNITPERTYPE(11,nuPeriodo);nuUnidades5=GETCONSUNITPERTYPE(12,nuPeriodo);nuUnidades6=GETCONSUNITPERTYPE(13,nuPeriodo);nuUnidades=nuUnidades1+nuUnidades2+nuUnidades3+nuUnidades4+nuUnidades5+nuUnidades6;SETUNITS(nuUnidades);nuValFijo=OBTVALORFIJORANGDIR(inuCompType,inuClassServ,inuConcept,IdtFechaini,IdtFechafin,nuUnidades,nuFOT,sbTarifaPersonalizada);nuValFacturado=GETBILLEDCHARGEBYPROD(null,null);ValorAlumbrado=nuValFijo-nuValFacturado;,);,Liquida=1;);,););if(Liquida=1,ValorAlumbrado=FNULIQBASICCHARGE(inuCompType,inuClassServ,inuConcept,IdtFechaini,IdtFechafin,inuFOT,isbPersTariff,isbProportionality);,);ValorAlumbrado=ValorAlumbrado|DPTO=STATE();LOCALIDAD=OBTLOCALIDADINSTPROD();CATEGORIA=CATEGORY();INUCOMPTYPE=-#;INUCLASSSERV=-#;INUCONCEPT=NULL;INUFOT=#;ISBPERSTARIFF="N";ISBPROPORTIONALITY="S";INUCONSUMTYPE=#;LIQUIDA=#;PE_GETCONSUMDATESPERID(INUCONSUMTYPE,IDTFECHAINI,IDTFECHAFIN);IF(CATEGORIA=#,LIQUIDA=#;,IF(CATEGORIA>=#&&CATEGORIA<=##,IF(LOCALIDAD=####||LOCALIDAD=####||LOCALIDAD=####||LOCALIDAD=####||LOCALIDAD=####||LOCALIDAD=####,PKINSTANCEDATAMGR.OBTCANTIDADCOMPONENTES(ONUCANTCOMPONENTES);IF(ONUCANTCOMPONENTES=#,PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(NUPERIODO);NUPERIODOACTUAL=OBTSIPERIODOACTUAL();SBANOMES=OBTCADPEFAPECOLIQ(NUPERIODO);IF(NUPERIODOACTUAL=#,SBDOCUMENTOSOPORTE=UT_STRING.FSBCONCAT("CM",SBANOMES,"-");,SBDOCUMENTOSOPORTE=UT_STRING.FSBCONCAT("CM-PR",SBANOMES,"-"););PKINSTANCEDATAMGR.GETCG_COMPONENT(NUCOMPONENTE);SBDOCUMENTOSOPORTE=UT_STRING.FSBCONCAT(SBDOCUMENTOSOPORTE,NUCOMPONENTE,"-IC-");SETSUPPORTDOC(SBDOCUMENTOSOPORTE);NUUNIDADES#=GETCONSUNITPERTYPE(#,NUPERIODO);NUUNIDADES#=GETCONSUNITPERTYPE(#,NUPERIODO);NUUNIDADES#=GETCONSUNITPERTYPE(#,NUPERIODO);NUUNIDADES#=GETCONSUNITPERTYPE(##,NUPERIODO);NUUNIDADES#=GETCONSUNITPERTYPE(##,NUPERIODO);NUUNIDADES#=GETCONSUNITPERTYPE(##,NUPERIODO);NUUNIDADES=NUUNIDADES#+NUUNIDADES#+NUUNIDADES#+NUUNIDADES#+NUUNIDADES#+NUUNIDADES#;SETUNITS(NUUNIDADES);NUVALFIJO=OBTVALORFIJORANGDIR(INUCOMPTYPE,INUCLASSSERV,INUCONCEPT,IDTFECHAINI,IDTFECHAFIN,NUUNIDADES,NUFOT,SBTARIFAPERSONALIZADA);NUVALFACTURADO=GETBILLEDCHARGEBYPROD(NULL,NULL);VALORALUMBRADO=NUVALFIJO-NUVALFACTURADO;,);,LIQUIDA=#;);,););IF(LIQUIDA=#,VALORALUMBRADO=FNULIQBASICCHARGE(INUCOMPTYPE,INUCLASSSERV,INUCONCEPT,IDTFECHAINI,IDTFECHAFIN,INUFOT,ISBPERSTARIFF,ISBPROPORTIONALITY);,);VALORALUMBRADO=VALORALUMBRADO
701|462|ENERG페 MDO REGULADO|1460|ALUMBRADO MERCADO REGIONAL|TipoComponente=7213;Departamento=STATE();Localidad=LOCALITY();Categoria=CATEGORY();SubCategoria=SUBCATEGORY();inuConcepto=null;inuFOT=1;isbPersTarifa="N";isbProportionality="S";inuConsumoType=3;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(nuPeriodo);nuPeriodoActual=OBTSIPERIODOACTUAL();if(nuPeriodoActual=1,sbDocumentoSoporte=UT_STRING.FSBCONCAT("CM",sbAnoMes,"-");,sbDocumentoSoporte=UT_STRING.FSBCONCAT("CM-PR",sbAnoMes,"-"););sbDocumentoSoporte=UT_STRING.FSBCONCAT(sbDocumentoSoporte,TipoComponente,"-IC-");SETSUPPORTDOC(sbDocumentoSoporte);PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(PeriLiqui);idFinalDate=FDTGETFINALCONSUMDATE(PeriLiqui);ClaseServicio=PE_GETCLASSSERVICE(TipoComponente,idFinalDate);if(ClaseServicio=2501||ClaseServicio=2502,Caso=CASOALUMBRADOMERCADOREGIONAL(TipoComponente,ClaseServicio,Departamento,Localidad,Categoria,SubCategoria,1);if(Caso=1,PE_GETCONSUMDATESPERID(inuConsumoType,idtFechaIni,idtFechaFin);ValorAlumbrado=FNULIQBASICCHARGE(TipoComponente,ClaseServicio,inuConcepto,idtFechaIni,idtFechaFin,inuFOT,isbPersTarifa,isbProportionality);,if(Caso=2,ValorAlumbrado=PE_STRLIGHTMINCAPSET(inuFOT,isbPersTarifa);,if(Caso=3,ValorAlumbrado=PE_STRLIGHTMINWAGCAPSETT(inuFOT,isbPersTarifa);,);););,)|TIPOCOMPONENTE=####;DEPARTAMENTO=STATE();LOCALIDAD=LOCALITY();CATEGORIA=CATEGORY();SUBCATEGORIA=SUBCATEGORY();INUCONCEPTO=NULL;INUFOT=#;ISBPERSTARIFA="N";ISBPROPORTIONALITY="S";INUCONSUMOTYPE=#;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(NUPERIODO);NUPERIODOACTUAL=OBTSIPERIODOACTUAL();IF(NUPERIODOACTUAL=#,SBDOCUMENTOSOPORTE=UT_STRING.FSBCONCAT("CM",SBANOMES,"-");,SBDOCUMENTOSOPORTE=UT_STRING.FSBCONCAT("CM-PR",SBANOMES,"-"););SBDOCUMENTOSOPORTE=UT_STRING.FSBCONCAT(SBDOCUMENTOSOPORTE,TIPOCOMPONENTE,"-IC-");SETSUPPORTDOC(SBDOCUMENTOSOPORTE);PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(PERILIQUI);IDFINALDATE=FDTGETFINALCONSUMDATE(PERILIQUI);CLASESERVICIO=PE_GETCLASSSERVICE(TIPOCOMPONENTE,IDFINALDATE);IF(CLASESERVICIO=####||CLASESERVICIO=####,CASO=CASOALUMBRADOMERCADOREGIONAL(TIPOCOMPONENTE,CLASESERVICIO,DEPARTAMENTO,LOCALIDAD,CATEGORIA,SUBCATEGORIA,#);IF(CASO=#,PE_GETCONSUMDATESPERID(INUCONSUMOTYPE,IDTFECHAINI,IDTFECHAFIN);VALORALUMBRADO=FNULIQBASICCHARGE(TIPOCOMPONENTE,CLASESERVICIO,INUCONCEPTO,IDTFECHAINI,IDTFECHAFIN,INUFOT,ISBPERSTARIFA,ISBPROPORTIONALITY);,IF(CASO=#,VALORALUMBRADO=PE_STRLIGHTMINCAPSET(INUFOT,ISBPERSTARIFA);,IF(CASO=#,VALORALUMBRADO=PE_STRLIGHTMINWAGCAPSETT(INUFOT,ISBPERSTARIFA);,);););,)
701|462|ENERG페 MDO REGULADO|9528|CONTRIBUCI흁 ACTIVA|if(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,Liquida=0;Categoria=CATEGORY();Subcategoria=SUBCATEGORY();if(OBTCOMPPRODACTUAL(7278,2706)<>-1||OBTCOMPPRODACTUAL(7278,2707)<>-1||OBTCOMPPRODACTUAL(7278,2708)<>-1||OBTCOMPPRODACTUAL(7278,2709)<>-1||OBTCOMPPRODACTUAL(7278,2710)<>-1||OBTCOMPPRODACTUAL(7278,2713)<>-1,Liquida=0;,if(OBTCOMPPRODACTUAL(7278,2678)<>-1||OBTCOMPPRODACTUAL(7278,2680)<>-1,Liquida=0;,if(Categoria=1,if(SubCategoria=5||SubCategoria=6,Liquida=1;,);,Liquida=1;);););if(Liquida=1,InuTipocomp=-1;InuClasserv=-1;InuFOT=1;IsbTarifaperson="N";nuPeriAct=PKBOPERICOSE.FNUIFCURRENTCONSUMPERIOD();if(nuPeriAct=1,SbDocuSopo="CN";,SbDocuSopo="CN-PR";);PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(nuPeriodo);sbFecha=OBTCADPEFAPECOLIQ(nuPeriodo);sbConcat="-";SbCargdoso=UT_STRING.FSBCONCAT(SbDocuSopo,sbFecha,sbConcat);SETSUPPORTDOC(SbCargdoso);PKINSTANCEDATAMGR.SETCG_CONSUMPTIONTYPE(3);NuValorBase=GETTOTLIQBASECONC();PE_GETCONSUMDATESPERID(3,IdtFechaIni,IdtFechaFin);NuTarifpor=OBTVALORTARIFAVALORPORCENTUAL(InuTipocomp,InuClasserv,null,IdtFechaIni,IdtFechaFin,InuFOT,IsbTarifaperson);SETUNITS(NuTarifpor);Valor=NuValorBase*NuTarifpor*(1/100);,Valor=0;);,)|IF(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,LIQUIDA=#;CATEGORIA=CATEGORY();SUBCATEGORIA=SUBCATEGORY();IF(OBTCOMPPRODACTUAL(####,####)<>-#||OBTCOMPPRODACTUAL(####,####)<>-#||OBTCOMPPRODACTUAL(####,####)<>-#||OBTCOMPPRODACTUAL(####,####)<>-#||OBTCOMPPRODACTUAL(####,####)<>-#||OBTCOMPPRODACTUAL(####,####)<>-#,LIQUIDA=#;,IF(OBTCOMPPRODACTUAL(####,####)<>-#||OBTCOMPPRODACTUAL(####,####)<>-#,LIQUIDA=#;,IF(CATEGORIA=#,IF(SUBCATEGORIA=#||SUBCATEGORIA=#,LIQUIDA=#;,);,LIQUIDA=#;);););IF(LIQUIDA=#,INUTIPOCOMP=-#;INUCLASSERV=-#;INUFOT=#;ISBTARIFAPERSON="N";NUPERIACT=PKBOPERICOSE.FNUIFCURRENTCONSUMPERIOD();IF(NUPERIACT=#,SBDOCUSOPO="CN";,SBDOCUSOPO="CN-PR";);PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(NUPERIODO);SBFECHA=OBTCADPEFAPECOLIQ(NUPERIODO);SBCONCAT="-";SBCARGDOSO=UT_STRING.FSBCONCAT(SBDOCUSOPO,SBFECHA,SBCONCAT);SETSUPPORTDOC(SBCARGDOSO);PKINSTANCEDATAMGR.SETCG_CONSUMPTIONTYPE(#);NUVALORBASE=GETTOTLIQBASECONC();PE_GETCONSUMDATESPERID(#,IDTFECHAINI,IDTFECHAFIN);NUTARIFPOR=OBTVALORTARIFAVALORPORCENTUAL(INUTIPOCOMP,INUCLASSERV,NULL,IDTFECHAINI,IDTFECHAFIN,INUFOT,ISBTARIFAPERSON);SETUNITS(NUTARIFPOR);VALOR=NUVALORBASE*NUTARIFPOR*(#/###);,VALOR=#;);,)
701|462|ENERG페 MDO REGULADO|9531|SUBSIDIO CONSUMO ACTIVA|if(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,Categoria=CATEGORY();SubCategoria=SUBCATEGORY();if(Categoria=1,if(SubCategoria<=3,inuTipoComp=49;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(Peri_liqu);idtFinalDate=FDTGETFINALCONSUMDATE(Peri_liqu);inuClasServ=PE_GETCLASSSERVICE(inuTipoComp,idtFinalDate);if(inuClasServ=-1,inuClasServ=3112;,);PKINSTANCEDATAMGR.OBTPERACTUAL(Peri_actu);periodo=OBTCADPEFAPECOLIQ(Peri_liqu);if(Peri_actu=Peri_liqu,Token=UT_STRING.FSBCONCAT("SU",periodo,"-");,Token=UT_STRING.FSBCONCAT("SU-PR",periodo,"-"););SETSUPPORTDOC(Token);TipoConsumo=3;und_leidas=GETCONSUNITPERTYPE(TipoConsumo,Peri_liqu);TipoConsumo2=13;unidaforadas=GETCONSUNITPERTYPE(TipoConsumo2,Peri_liqu);ConceptoBase=90;inuFOT=1;isbPersTariff="N";isbDirectRange="N";PE_GETCONSUMDATESPERID(3,IdtFechaIni,IdtFechaFin);LIQCONSDISCPERCTARIFF(ConceptoBase,TipoConsumo,inuTipoComp,inuClasServ,inuFOT,isbPersTariff,isbDirectRange,IdtFechaIni,IdtFechaFin,unidades_aforadas,uni_liq,Valor_Cargo);valor_mes=Valor_Cargo;SETUNITS(uni_liq);PKINSTANCEDATAMGR.SETCG_CONSUMPTIONTYPE(TipoConsumo);ValorCargo=valor_mes;,);,);,)|IF(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,CATEGORIA=CATEGORY();SUBCATEGORIA=SUBCATEGORY();IF(CATEGORIA=#,IF(SUBCATEGORIA<=#,INUTIPOCOMP=##;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(PERI_LIQU);IDTFINALDATE=FDTGETFINALCONSUMDATE(PERI_LIQU);INUCLASSERV=PE_GETCLASSSERVICE(INUTIPOCOMP,IDTFINALDATE);IF(INUCLASSERV=-#,INUCLASSERV=####;,);PKINSTANCEDATAMGR.OBTPERACTUAL(PERI_ACTU);PERIODO=OBTCADPEFAPECOLIQ(PERI_LIQU);IF(PERI_ACTU=PERI_LIQU,TOKEN=UT_STRING.FSBCONCAT("SU",PERIODO,"-");,TOKEN=UT_STRING.FSBCONCAT("SU-PR",PERIODO,"-"););SETSUPPORTDOC(TOKEN);TIPOCONSUMO=#;UND_LEIDAS=GETCONSUNITPERTYPE(TIPOCONSUMO,PERI_LIQU);TIPOCONSUMO#=##;UNIDAFORADAS=GETCONSUNITPERTYPE(TIPOCONSUMO#,PERI_LIQU);CONCEPTOBASE=##;INUFOT=#;ISBPERSTARIFF="N";ISBDIRECTRANGE="N";PE_GETCONSUMDATESPERID(#,IDTFECHAINI,IDTFECHAFIN);LIQCONSDISCPERCTARIFF(CONCEPTOBASE,TIPOCONSUMO,INUTIPOCOMP,INUCLASSERV,INUFOT,ISBPERSTARIFF,ISBDIRECTRANGE,IDTFECHAINI,IDTFECHAFIN,UNIDADES_AFORADAS,UNI_LIQ,VALOR_CARGO);VALOR_MES=VALOR_CARGO;SETUNITS(UNI_LIQ);PKINSTANCEDATAMGR.SETCG_CONSUMPTIONTYPE(TIPOCONSUMO);VALORCARGO=VALOR_MES;,);,);,)
701|465|ENERG페 MDO REGULADO|545|CONS ENERG페 ACTIV FUERA PUNTA|if(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,inuTipoComp=49;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(Peri_liqu);idtFinalDate=FDTGETFINALCONSUMDATE(Peri_liqu);inuClasServ=PE_GETCLASSSERVICE(inuTipoComp,idtFinalDate);if(inuClasServ=-1,IsbCriterioClaseGen=3112;IsbCriterioClase=UT_CONVERT.FSBNUMBERTOCHAR(IsbCriterioClaseGen);,IsbCriterioClase=UT_CONVERT.FSBNUMBERTOCHAR(inuClasServ););TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBTIPOCOMP(),inuTipoComp);TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBCLASESER(),IsbCriterioClase);TipoConsumo=1;TipoConsumo2=11;unidades_aforadas=GETCONSUNITPERTYPE(TipoConsumo2,Peri_liqu);InuFOT=1;IsbDirectrank="N";IsbPerstariff="N";PE_GETCONSUMDATESPERID(1,IdtFechaIni,IdtFechaFin);Consumo=LIQCHARGESCONSBYRANKS(TipoConsumo,InuFOT,IsbDirectrank,IsbPerstariff,IdtFechaIni,IdtFechaFin,unidades_aforadas);PKINSTANCEDATAMGR.GETCG_CONSECCACHE(nuconsecutivo);consecutivo1=UPDCONSLIQBYPERTYPE(TipoConsumo2,nuconsecutivo);,)|IF(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,INUTIPOCOMP=##;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(PERI_LIQU);IDTFINALDATE=FDTGETFINALCONSUMDATE(PERI_LIQU);INUCLASSERV=PE_GETCLASSSERVICE(INUTIPOCOMP,IDTFINALDATE);IF(INUCLASSERV=-#,ISBCRITERIOCLASEGEN=####;ISBCRITERIOCLASE=UT_CONVERT.FSBNUMBERTOCHAR(ISBCRITERIOCLASEGEN);,ISBCRITERIOCLASE=UT_CONVERT.FSBNUMBERTOCHAR(INUCLASSERV););TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBTIPOCOMP(),INUTIPOCOMP);TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBCLASESER(),ISBCRITERIOCLASE);TIPOCONSUMO=#;TIPOCONSUMO#=##;UNIDADES_AFORADAS=GETCONSUNITPERTYPE(TIPOCONSUMO#,PERI_LIQU);INUFOT=#;ISBDIRECTRANK="N";ISBPERSTARIFF="N";PE_GETCONSUMDATESPERID(#,IDTFECHAINI,IDTFECHAFIN);CONSUMO=LIQCHARGESCONSBYRANKS(TIPOCONSUMO,INUFOT,ISBDIRECTRANK,ISBPERSTARIFF,IDTFECHAINI,IDTFECHAFIN,UNIDADES_AFORADAS);PKINSTANCEDATAMGR.GETCG_CONSECCACHE(NUCONSECUTIVO);CONSECUTIVO#=UPDCONSLIQBYPERTYPE(TIPOCONSUMO#,NUCONSECUTIVO);,)
701|465|ENERG페 MDO REGULADO|546|CONSUMO ENERG페 ACTIVA PUNTA|if(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,inuTipoComp=49;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(Peri_liqu);idtFinalDate=FDTGETFINALCONSUMDATE(Peri_liqu);inuClasServ=PE_GETCLASSSERVICE(inuTipoComp,idtFinalDate);if(inuClasServ=-1,IsbCriterioClaseGen=3112;IsbCriterioClase=UT_CONVERT.FSBNUMBERTOCHAR(IsbCriterioClaseGen);,IsbCriterioClase=UT_CONVERT.FSBNUMBERTOCHAR(inuClasServ););TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBTIPOCOMP(),inuTipoComp);TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBCLASESER(),IsbCriterioClase);TipoConsumo=2;TipoConsumo2=12;unidades_aforadas=GETCONSUNITPERTYPE(TipoConsumo2,Peri_liqu);InuFOT=1;IsbDirectrank="N";IsbPerstariff="N";PE_GETCONSUMDATESPERID(2,IdtFechaIni,IdtFechaFin);Consumo=LIQCHARGESCONSBYRANKS(TipoConsumo,InuFOT,IsbDirectrank,IsbPerstariff,IdtFechaIni,IdtFechaFin,unidades_aforadas);PKINSTANCEDATAMGR.GETCG_CONSECCACHE(nuconsecutivo);consecutivo1=UPDCONSLIQBYPERTYPE(TipoConsumo2,nuconsecutivo);,)|IF(FBOGETPEWASEXCLUDEDPERIOD()=FALSE||FBOGETPEWASEXCLUDEDPERIOD()=TRUE,INUTIPOCOMP=##;PKINSTANCEDATAMGR.GETCG_CONSUMPERIOD(PERI_LIQU);IDTFINALDATE=FDTGETFINALCONSUMDATE(PERI_LIQU);INUCLASSERV=PE_GETCLASSSERVICE(INUTIPOCOMP,IDTFINALDATE);IF(INUCLASSERV=-#,ISBCRITERIOCLASEGEN=####;ISBCRITERIOCLASE=UT_CONVERT.FSBNUMBERTOCHAR(ISBCRITERIOCLASEGEN);,ISBCRITERIOCLASE=UT_CONVERT.FSBNUMBERTOCHAR(INUCLASSERV););TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBTIPOCOMP(),INUTIPOCOMP);TA_BOCRITERIOSBUSQUEDA.ESTCRITERIOMEMORIA(TA_BOCRITERIOSBUSQUEDA.FSBCLASESER(),ISBCRITERIOCLASE);TIPOCONSUMO=#;TIPOCONSUMO#=##;UNIDADES_AFORADAS=GETCONSUNITPERTYPE(TIPOCONSUMO#,PERI_LIQU);INUFOT=#;ISBDIRECTRANK="N";ISBPERSTARIFF="N";PE_GETCONSUMDATESPERID(#,IDTFECHAINI,IDTFECHAFIN);CONSUMO=LIQCHARGESCONSBYRANKS(TIPOCONSUMO,INUFOT,ISBDIRECTRANK,ISBPERSTARIFF,IDTFECHAINI,IDTFECHAFIN,UNIDADES_AFORADAS);PKINSTANCEDATAMGR.GETCG_CONSECCACHE(NUCONSECUTIVO);CONSECUTIVO#=UPDCONSLIQBYPERTYPE(TIPOCONSUMO#,NUCONSECUTIVO);,)
